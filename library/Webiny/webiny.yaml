###############################################################################
# This is main config file for Webiny framework.
# DO NOT edit this file!
#
# If you wish to edit the config, please use 'my_config.yaml' file.
###############################################################################

system:
    display_errors: true
    environment: 'development'
    cache: true
bridges:
    cache:
        apc: '\Webiny\Bridge\Cache\Memory\APC'
        couchbase: '\Webiny\Bridge\Cache\Memory\Couchbase'
        memcache: '\Webiny\Bridge\Cache\Memory\Memcache'
        redis: '\Webiny\Bridge\Cache\Memory\Redis'
    yaml: 'Spyc\Spyc'
    crypt: '\Webiny\Bridge\Crypt\CryptLib\CryptLib'
    oauth2: '\Webiny\Bridge\OAuth2\OAuth2\OAuth2'
    image: '\Webiny\Bridge\Image\Imagine\Imagine'
    template_engine:
        smarty: '\Webiny\Bridge\TemplateEngine\Smarty\Smarty'
additional_libraries:
    Jamm\Memory: '../Memory'
    Psr: '../Psr'
    CryptLib: '../PHP-CryptLib/lib/CryptLib'
    OAuth2: '../OAuth2'
    Imagine: '../Imagine/lib/Imagine'
    App: '/www/webiny/projects/weby.io/app'
    Swift_: '../SwiftMailer/lib/classes'
components:
    logger:
        formatters:
            default:
                date_format: 'Y-m-d H:i:s'
            file:
                record_format: '%datetime% [%name%] [%level%]: %message%\nContext: %context%\nExtra: %extra%\n\n'
            webiny_tray:
                method: new_notification
                date_format: 'Y-m-d H:i:s'
        handlers:
            udp:
                host: 192.168.1.10:41234
        tray: 192.168.1.10:5000
    http:
        session:
            storage:
                driver: '\Webiny\Component\Http\Request\Session\Storage\NativeStorage'
                params:
                    cache_id: 'webiny_cache'
            prefix: 'wfs_'
            expiretime: 86400
        trusted_proxies: ['192.168.1.9', '192.168.1.128', '127.0.0.1']
        trusted_headers:
            client_ip: 'X_FORWARDED_FOR'
            client_host: 'X_FORWARDED_HOST'
            client_proto: 'X_FORWARDED_PROTO'
            client_port: 'X_FORWARDED_PORT'
        cookie:
            storage:
                driver: '\Webiny\Component\Http\Request\Cookie\Storage\NativeStorage'
            prefix: 'wfc_'
            http_only: 'true'
            expiretime: 86400
    oauth2:
        servers:
            facebook: '\Webiny\Component\OAuth2\Server\Facebook'
            google: '\Webiny\Component\OAuth2\Server\Google'
            linkedin: '\Webiny\Component\OAuth2\Server\LinkedIn'
            twitter: '\Webiny\Component\OAuth2\Server\Twitter'
    mailer:
        default:
            character_set: utf-8
            max_line_length: 78
            priority: 2 # high priority
            sender:
                email: 'welcome@weby.io'
                name: 'Weby.io Team'
            transport:
                type: mail
                #host: smtp.gmail.com
                #port: 465
                #username: adrian1358@gmail.com
                #password: 4ndtr051xx5!
                #encryption: ssl
                #auth_mode: login
            antiflood:
                threshold: 99
                sleep: 1
            disable_delivery: false
    template_engine:
            engines:
                smarty:
                    force_compile: false
                    cache_dir: '/var/tmp/smarty/cache'
                    compile_dir: '/var/tmp/smarty/compile'
                    auto_escape_output: false
    image:
        library: gd
        quality: 100
oauth2:
    facebook_auth:
        server: facebook
        client_id: 589844551062032
        client_secret: 5caa1a62ba17585f1dbc2e12712e9ee7
        scope: email
        redirect_uri: '/security/login-fb/'
    google_auth:
        server: google
        client_id: 50628154574.apps.googleusercontent.com
        client_secret: d7dbtid5X-3wKO9m4dd3T2JB
        scope: openid%20profile%20email
        redirect_uri: '/security/login-gp/'

security:
    encoders:
        default:
            driver: '\Webiny\Component\Security\Encoder\Drivers\Crypt'
            params: ['webiny_crypt']
            salt: 'CHANGE THIS SECRET'
    providers:
        memory:
            admin: {password: 123123, roles: 'ROLE_ADMIN'}
        oauth2:
            driver: 'Webiny\Component\Security\User\Providers\OAuth2\OAuth2'
    role_hierarchy:
        ROLE_USER: ROLE_EDITOR
        ROLE_ADMIN: ROLE_USER
    access_control:
        rules:
            - {path: '/^\/[a-zA-Z0-9-_]+\/[a-zA-Z0-9-_]+\/[a-zA-Z0-9]{13}$/', roles: ROLE_ANONYMOUS}
            - {path: '/^\/about/', roles: ROLE_ANONYMOUS}
            - {path: '/^\/statistics/', roles: ROLE_ANONYMOUS}
        decision_strategy: affirmative
    firewalls:
        userarea:
            realm_name: 'Weby.io Authentication'
            url_pattern: ''
            anonymous: true
            remember_me: true
            #encoder: default
            security_key: THIS_IS_editor_KEY98
            provider: oauth2
            login:
                login_path: '/'
                failure_path: '/?error=1'
                target_path: '/security/check-logged-user/'
                providers:
                    facebook:
                        driver: '\Webiny\Component\Security\Authentication\Providers\OAuth2\OAuth2'
                        submit_path: '/security/login-fb/'
                        params:
                            server: facebook_auth
                            roles: [ROLE_USER]
                    google:
                        driver: '\Webiny\Component\Security\Authentication\Providers\OAuth2\OAuth2'
                        submit_path: '/security/login-gp/'
                        params:
                            server: google_auth
                            roles: [ROLE_USER]
            logout:
                path: '/logout'
                target: ''

parameters:
    logger.class: \Webiny\Component\Logger\Logger
    logger.driver.class: \Webiny\Component\Logger\Drivers\Webiny
    logger.formatter.tray.class: \Webiny\Component\Logger\Drivers\Webiny\Formatters\WebinyTrayFormatter
    logger.processor.file_line.class: \Webiny\Component\Logger\Drivers\Webiny\Processors\FileLineProcessor
    logger.processor.memory_usage.class: \Webiny\Component\Logger\Drivers\Webiny\Processors\MemoryUsageProcessor
    cache.class: '\Webiny\Component\Cache\Cache'
    crypt.class: '\Webiny\Component\Crypt\Crypt'
    security.voters.test: '\Webiny\Component\Security\Authorization\Voters\TestVoter'

services:
    crypt:
        webiny_crypt:
            class: %crypt.class%
            arguments: ['Blowfish', 'CCM', 'rijndael-128', '_FOO_VECTOR']
    #cache:
        webiny_cache:
            factory: "%cache.class%"
            method: "Couchbase"
            method_arguments: ["webiny", '', "default"]
    logger:
        handlers:
            udp:
                class: \Webiny\Component\Logger\Drivers\Webiny\Handlers\UDPHandler
                arguments: [[], true, true]
                calls:
                    - [addProcessor, [%logger.processor.file_line.class%]]
                    - [addProcessor, [%logger.processor.memory_usage.class%]]
                    - [setFormatter, [%logger.formatter.tray.class%]]
        webiny_logger:
            class: %logger.class%
            arguments: [System, %logger.driver.class%]
            calls:
                - [addHandler, [@logger.handlers.udp]]
    storage:
        local:
            class: \Webiny\Component\Storage\Storage
            arguments:
                driver:
                    object: \Webiny\Component\Storage\Driver\Local\Local
                    object_arguments:
                        - /www/webiny/projects/weby.io/public_html/uploads/webies # Absolute root path
                        - http://pavel910.homeftp.net/uploads/webies # Web root path
                        - false # DateFolderStructure
                        - true # Create folder if it doesn't exist

        webies:
            class: \Webiny\Component\Storage\Storage
            arguments:
                driver:
                    object: \Webiny\Component\Storage\Driver\Local\Local
                    object_arguments:
                        - /www/webiny/projects/weby.io/public_html/uploads/webies # Absolute root path
                        - http://pavel910.homeftp.net/uploads/webies # Web root path
                        - true # DateFolderStructure
                        - true # Create folder if it doesn't exist
    cache:
        webiny_cache:
            factory: "%cache.class%"
            method: "Memcache"
            method_arguments: ['192.168.1.11', '11211']